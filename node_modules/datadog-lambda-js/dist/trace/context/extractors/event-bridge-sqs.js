"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.EventBridgeSQSEventTraceExtractor = void 0;
var utils_1 = require("../../../utils");
var EventBridgeSQSEventTraceExtractor = /** @class */ (function () {
    function EventBridgeSQSEventTraceExtractor(tracerWrapper) {
        this.tracerWrapper = tracerWrapper;
    }
    EventBridgeSQSEventTraceExtractor.prototype.extract = function (event) {
        var _a, _b, _c;
        var body = (_b = (_a = event === null || event === void 0 ? void 0 : event.Records) === null || _a === void 0 ? void 0 : _a[0]) === null || _b === void 0 ? void 0 : _b.body;
        if (body === undefined)
            return null;
        try {
            var parsedBody = JSON.parse(body);
            var headers = (_c = parsedBody === null || parsedBody === void 0 ? void 0 : parsedBody.detail) === null || _c === void 0 ? void 0 : _c._datadog;
            if (headers === undefined)
                return null;
            var traceContext = this.tracerWrapper.extract(headers);
            if (traceContext === null)
                return null;
            (0, utils_1.logDebug)("Extracted trace context from EventBridge-SQS event", { traceContext: traceContext, event: event });
            return traceContext;
        }
        catch (error) {
            if (error instanceof Error) {
                (0, utils_1.logDebug)("Unable to extract trace context from EventBridge-SQS event", error);
            }
        }
        return null;
    };
    return EventBridgeSQSEventTraceExtractor;
}());
exports.EventBridgeSQSEventTraceExtractor = EventBridgeSQSEventTraceExtractor;
//# sourceMappingURL=event-bridge-sqs.js.map